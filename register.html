<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Patient Registration</title>
<style>
body { font-family: Arial, sans-serif; background: #f4f6f8; padding: 20px; }
h2 { text-align: center; margin-bottom: 20px; }
.form-row { display: grid; grid-template-columns: 1fr auto auto; gap: 30px; margin-bottom: 20px; }
.form-group { display: flex; flex-direction: column; }
label { font-weight: bold; margin-bottom: 5px; }
input { padding: 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; }
button { padding: 10px; border: none; border-radius: 6px; cursor: pointer; width: 100%; background: #4CAF50; color: white; font-size: 16px; }
button:hover { background: #43a047; }
table { width: 100%; border-collapse: collapse; margin-top: 20px; }
th, td { padding: 10px; border: 1px solid #ccc; text-align: left; }
th { background: #f0f0f0; }
.delete-btn { background: #e53935; color: white; border: none; padding: 6px 10px; border-radius: 5px; cursor: pointer; }
.delete-btn:hover { background: #d32f2f; }
</style>
</head>
<body>

<h2>Register New Patient</h2>

<div class="form-row">
    <div class="form-group">
        <label>Full Name</label>
        <input type="text" id="regPatientName" placeholder="Enter full name">
    </div>
    <div class="form-group">
        <label>Age</label>
        <input type="number" id="regPatientAge" placeholder="Age" style="width:80px;">
    </div>
    <div class="form-group">
        <label>Contact Number</label>
        <input type="text" id="regContactNumber" placeholder="Enter contact number" style="width:180px;">
    </div>
</div>

<button onclick="registerPatient()">Register Patient</button>

<h3>Registered Patients</h3>
<table id="registeredTable">
    <thead>
        <tr>
            <th>Full Name</th>
            <th>Age</th>
            <th>Contact</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

// ðŸ”‘ Your Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyBWaH3wC79rB2qGtOqYYWogb4nlPbPCoqs",
  authDomain: "patient-system-97412.firebaseapp.com",
  projectId: "patient-system-97412",
  storageBucket: "patient-system-97412.firebasestorage.app",
  messagingSenderId: "988662086004",
  appId: "1:988662086004:web:3427af061c370a87521421",
  measurementId: "G-VXTREJV1FG"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// Load patients
async function loadRegisteredPatients() {
    const snapshot = await getDocs(collection(db, "patients"));
    const tableBody = document.querySelector("#registeredTable tbody");
    tableBody.innerHTML = '';
    snapshot.forEach(docSnap => {
        const p = docSnap.data();
        const row = document.createElement("tr");
        row.dataset.docId = docSnap.id;
        row.innerHTML = `
            <td>${p.name}</td>
            <td>${p.age}</td>
            <td>${p.contact}</td>
            <td><button class="delete-btn" onclick="deletePatient('${docSnap.id}', this)">Delete</button></td>
        `;
        tableBody.appendChild(row);
    });
}

// Register patient
async function registerPatient() {
    const name = document.getElementById("regPatientName").value.trim();
    const age = document.getElementById("regPatientAge").value.trim();
    const contact = document.getElementById("regContactNumber").value.trim();
    if(!name || !age || !contact){ alert("Please fill all fields!"); return; }

    await addDoc(collection(db, "patients"), { name, age, contact });
    document.getElementById("regPatientName").value = '';
    document.getElementById("regPatientAge").value = '';
    document.getElementById("regContactNumber").value = '';
    loadRegisteredPatients();
}

// Delete patient
async function deletePatient(id, btn){
    await deleteDoc(doc(db, "patients", id));
    btn.parentElement.parentElement.remove();
}

// Initialize
window.onload = loadRegisteredPatients;
</script>

</body>
</html>
